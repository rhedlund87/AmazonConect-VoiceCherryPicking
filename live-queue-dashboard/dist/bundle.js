/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var e={159:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(601),o=n.n(r),i=n(314),s=n.n(i)()(o());s.push([e.id,'/* Variables */\n:root {\n    --primary-color: #077398;\n    --border-color: rgb(194, 193, 193);\n    --white: #ffffff;\n    --background-light: #f5f5f5;\n    --background-lighter: #f9f9f9;\n    --shadow-color: rgba(0, 0, 0, 0.1);\n}\n\n/* Base Styles */\nbody {\n    font-family: "Amazon Ember", Arial, sans-serif;\n}\n\n/* Layout Components */\n.filter-container {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 25px;\n    background-color: var(--background-light);\n    border-radius: 5px;\n    margin-bottom: 20px;\n    box-shadow: 0 2px 4px var(--shadow-color);\n    gap: 20px;\n}\n\n.table-container {\n    width: 100%;\n    overflow: auto;\n    margin: 30px 0;\n    box-shadow: 0 0 20px var(--shadow-color);\n    border-radius: 5px;\n}\n\n/* Table Styles */\ntable {\n    width: 100%;\n    min-width: 800px;\n    border-collapse: separate;\n    border-spacing: 0;\n    border: 1px solid var(--border-color);\n}\n\nth {\n    background-color: var(--primary-color);\n    border: 1px solid var(--border-color);\n    color: var(--white);\n    padding: 15px 10px;\n    text-align: left;\n    top: 0;\n    z-index: 10;\n}\n\ntd {\n    padding: 12px 8px;\n    text-align: left;\n    border: 1px solid var(--border-color);\n    height: 40px;\n    background-color: var(--white);\n}\n\n/* Table Interactions */\ntr:hover td {\n    background-color: var(--background-light);\n}\n\ntr:nth-child(even) td {\n    background-color: var(--background-lighter);\n}\n\ntd:last-child {\n    width: 75px;\n    text-align: center;\n}\n\n/* Links */\ntd a {\n    color: var(--primary-color);\n    text-decoration: none;\n    display: block;\n}\n\ntd a:hover {\n    text-decoration: underline;\n    color: black;\n}\n\n/* Filter Elements */\n.filter-group {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    white-space: nowrap;\n    flex: 0 0 auto;\n}\n\n#queue-filter {\n    border-radius: 5px;\n    padding: 10px;\n    border: 1px solid var(--primary-color);\n    width: 200px;\n    flex: 0 0 auto;\n}\n\n.checkbox-group {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    white-space: nowrap;\n    flex: 0 0 auto;\n}\n\n#no-agent-filter {\n    width: 16px;\n    height: 16px;\n    cursor: pointer;\n    flex: 0 0 auto;\n}\n\n/* Button Styles */\n.button-container {\n    flex: 0 0 auto;\n}\n\n.btn-refresh, .pick-btn {\n    width: 200px;\n    padding: 10px 0;\n    background: var(--white);\n    border: 2px solid var(--primary-color);\n    text-transform: uppercase;\n    color: var(--primary-color);\n    border-radius: 5px;\n    cursor: pointer;\n    transition: all 0.3s ease;\n    flex: 0 0 auto;\n}\n\n.btn-refresh:hover, \n.pick-btn:hover {\n    background-color: var(--primary-color);\n    color: var(--white);\n}\n\n.btn-refresh.loading {\n    cursor: not-allowed;\n    opacity: 0.3;\n}\n\n.pick-btn {\n    display: none;\n    padding: 10px 20px;\n    width: 70px;\n}\n\n.pick-btn:disabled {\n    background-color: #ccc;\n    border-color: #ccc;\n    color: var(--white);\n    cursor: not-allowed;\n}\n\n/* Modal Styles */\n.modal {\n    display: none;\n    position: fixed;\n    z-index: 1;\n    left: 0;\n    top: 0;\n    width: 100%;\n    height: 100%;\n    background-color: rgba(0, 0, 0, 0.5);\n}\n\n.modal-content {\n    background-color: var(--white);\n    margin: 15% auto;\n    padding: 20px;\n    border: 1px solid #888;\n    width: 30%;\n    text-align: center;\n    border-radius: 12px;\n}\n\n.modal-content button {\n    padding: 10px 40px;\n    margin: 10px;\n    cursor: pointer;\n    border-radius: 5px;\n    background: var(--white);\n    border: 2px solid var(--primary-color);\n    text-transform: uppercase;\n    color: var(--primary-color);\n}\n\n.modal-content button:hover {\n    background-color: var(--primary-color);\n    color: var(--white);\n}\n\n.btn-yes {\n    background-color: var(--primary-color) !important;\n    color: var(--white) !important;\n}\n\n.btn-yes:hover,\n.btn-no:hover {\n    background-color: #354150 !important;\n    color: var(--white) !important;\n    border: 2px solid #354150 !important;\n}\n\n.btn-no {\n    color: var(--white);\n}\n\n/* Loading States */\n.loader-container {\n    position: fixed;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n    text-align: center;\n    z-index: 1000;\n}\n\n.loader {\n    border: 5px solid #f3f3f3;\n    border-top-color: #3498db;\n    border-radius: 50%;\n    width: 50px;\n    height: 50px;\n    animation: spin 1s linear infinite;\n    margin: 0 auto 20px;\n}\n\n.overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0, 0, 0, 0.5);\n    z-index: 999;\n}\n\n/* Animations */\n@keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n/* Responsive Styles */\n@media screen and (max-width: 768px) {\n    .filter-container {\n        flex-direction: column;\n        align-items: stretch;\n    }\n\n    .filter-group,\n    .checkbox-group,\n    .button-container {\n        width: 100%;\n    }\n\n    #queue-filter,\n    .btn-refresh {\n        width: 100%;\n    }\n\n    #queue-filter {\n        width: 75%;\n    }\n\n    .table-container {\n        margin: 15px 0;\n        border-radius: 0;\n    }\n\n    table {\n        font-size: 14px;\n    }\n\n    th, td {\n        padding: 8px 5px;\n    }\n}\n\n@media screen and (max-width: 480px) {\n    .filter-container {\n        padding: 10px;\n    }\n    .low-priority {\n        display: none;\n    }\n}\n\n/* Accessibility */\n.btn-refresh:focus,\n#queue-filter:focus,\n#no-agent-filter:active {\n    outline: 2px solid var(--primary-color);\n}\n\n@media (prefers-contrast: high) {\n    .filter-container,\n    .btn-refresh {\n        border: 2px solid #000;\n    }\n}',""]);const a=s},314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n="",r=void 0!==t[5];return t[4]&&(n+="@supports (".concat(t[4],") {")),t[2]&&(n+="@media ".concat(t[2]," {")),r&&(n+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),n+=e(t),r&&(n+="}"),t[2]&&(n+="}"),t[4]&&(n+="}"),n})).join("")},t.i=function(e,n,r,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var c=this[a][0];null!=c&&(s[c]=!0)}for(var l=0;l<e.length;l++){var u=[].concat(e[l]);r&&s[u[0]]||(void 0!==i&&(void 0===u[5]||(u[1]="@layer".concat(u[5].length>0?" ".concat(u[5]):""," {").concat(u[1],"}")),u[5]=i),n&&(u[2]?(u[1]="@media ".concat(u[2]," {").concat(u[1],"}"),u[2]=n):u[2]=n),o&&(u[4]?(u[1]="@supports (".concat(u[4],") {").concat(u[1],"}"),u[4]=o):u[4]="".concat(o)),t.push(u))}},t}},601:e=>{e.exports=function(e){return e[1]}},72:e=>{var t=[];function n(e){for(var n=-1,r=0;r<t.length;r++)if(t[r].identifier===e){n=r;break}return n}function r(e,r){for(var i={},s=[],a=0;a<e.length;a++){var c=e[a],l=r.base?c[0]+r.base:c[0],u=i[l]||0,d="".concat(l," ").concat(u);i[l]=u+1;var h=n(d),p={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==h)t[h].references++,t[h].updater(p);else{var g=o(p,r);r.byIndex=a,t.splice(a,0,{identifier:d,updater:g,references:1})}s.push(d)}return s}function o(e,t){var n=t.domAPI(t);return n.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;n.update(e=t)}else n.remove()}}e.exports=function(e,o){var i=r(e=e||[],o=o||{});return function(e){e=e||[];for(var s=0;s<i.length;s++){var a=n(i[s]);t[a].references--}for(var c=r(e,o),l=0;l<i.length;l++){var u=n(i[l]);0===t[u].references&&(t[u].updater(),t.splice(u,1))}i=c}}},659:e=>{var t={};e.exports=function(e,n){var r=function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}(e);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},56:(e,t,n)=>{e.exports=function(e){var t=n.nc;t&&e.setAttribute("nonce",t)}},825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(n){!function(e,t,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var o=void 0!==n.layer;o&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,o&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var i=n.sourceMap;i&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(r,e,t.options)}(t,e,n)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={id:r,exports:{}};return e[r](i,i.exports,n),i.exports}let r;function o(e){if(!r)throw new Error(null!=e?e:"Attempted to get Global AmazonConnectProvider that has not been set.");return r}function i(){return"randomUUID"in crypto?crypto.randomUUID():"10000000-1000-4000-8000-100000000000".replace(/[018]/g,(e=>{const t=parseInt(e);return(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)}))}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.nc=void 0;class s{constructor(){this.idsByHandler=new Map,this.handlersById=new Map}add(e){const t=this.idsByHandler.get(e);if(t)return{handlerId:t};const n=i();return this.idsByHandler.set(e,n),this.handlersById.set(n,e),{handlerId:n}}getIdByHandler(e){var t;return null!==(t=this.idsByHandler.get(e))&&void 0!==t?t:null}getHandlerById(e){var t;return null!==(t=this.handlersById.get(e))&&void 0!==t?t:null}get(){return[...this.idsByHandler.entries()].map((([e,t])=>({handler:e,handlerId:t})))}delete(e){const t=this.idsByHandler.get(e);return t&&this.handlersById.delete(t),this.idsByHandler.delete(e),{isEmpty:this.idsByHandler.size<1}}size(){return this.idsByHandler.size}}class a{constructor(){this.simpleSubscriptions=new Map,this.paramSubscriptions=new Map}add({namespace:e,key:t,parameter:n},r){var o,i,s,a,c;if(n){if(!this.paramSubscriptions.has(e))return void this.paramSubscriptions.set(e,new Map([[t,new Map([[n,r]])]]));if(!(null===(o=this.paramSubscriptions.get(e))||void 0===o?void 0:o.has(t)))return void(null===(i=this.paramSubscriptions.get(e))||void 0===i||i.set(t,new Map([[n,r]])));null===(a=null===(s=this.paramSubscriptions.get(e))||void 0===s?void 0:s.get(t))||void 0===a||a.set(n,r)}else{if(!this.simpleSubscriptions.has(e))return void this.simpleSubscriptions.set(e,new Map([[t,r]]));null===(c=this.simpleSubscriptions.get(e))||void 0===c||c.set(t,r)}}delete({namespace:e,key:t,parameter:n}){var r,o,i,s;n?(null===(o=null===(r=this.paramSubscriptions.get(e))||void 0===r?void 0:r.get(t))||void 0===o?void 0:o.delete(n))&&this.paramSubscriptions.get(e).get(t).size<1&&(null===(i=this.paramSubscriptions.get(e))||void 0===i||i.delete(t),this.paramSubscriptions.get(e).size<1&&this.paramSubscriptions.delete(e)):(null===(s=this.simpleSubscriptions.get(e))||void 0===s?void 0:s.delete(t))&&this.simpleSubscriptions.get(e).size<1&&this.simpleSubscriptions.delete(e)}get({namespace:e,key:t,parameter:n}){var r,o,i;return n?null===(i=null===(o=this.paramSubscriptions.get(e))||void 0===o?void 0:o.get(t))||void 0===i?void 0:i.get(n):null===(r=this.simpleSubscriptions.get(e))||void 0===r?void 0:r.get(t)}getOrAdd(e,t){let n=this.get(e);return n||(n=t(),this.add(e,n)),n}addOrUpdate(e,t,n){let r=this.get(e);return r=r?n(r):t(),this.add(e,r),r}getAllSubscriptions(){return[...Array.from(this.simpleSubscriptions.keys()).flatMap((e=>Array.from(this.simpleSubscriptions.get(e).keys()).flatMap((t=>({namespace:e,key:t}))))),...Array.from(this.paramSubscriptions.keys()).flatMap((e=>Array.from(this.paramSubscriptions.get(e).keys()).flatMap((t=>Array.from(this.paramSubscriptions.get(e).get(t).keys()).flatMap((n=>({namespace:e,key:t,parameter:n})))))))]}}class c{constructor(){this.subscriptions=new a}add(e,t){return this.subscriptions.getOrAdd(e,(()=>new s)).add(t)}get(e){var t,n;return null!==(n=null===(t=this.subscriptions.get(e))||void 0===t?void 0:t.get())&&void 0!==n?n:[]}getById(e,t){var n,r;return null!==(r=null===(n=this.subscriptions.get(e))||void 0===n?void 0:n.getHandlerById(t))&&void 0!==r?r:null}delete(e,t){var n,r;null!==(r=null===(n=this.subscriptions.get(e))||void 0===n?void 0:n.delete(t).isEmpty)&&void 0!==r&&r&&this.subscriptions.delete(e)}size(e){var t,n;return null!==(n=null===(t=this.subscriptions.get(e))||void 0===t?void 0:t.size())&&void 0!==n?n:0}isEmpty(e){return 0===this.size(e)}getAllSubscriptions(){return this.subscriptions.getAllSubscriptions()}getAllSubscriptionHandlerIds(){return this.subscriptions.getAllSubscriptions().reduce(((e,t)=>e.concat(this.get(t).map((({handlerId:e})=>({topic:t,handlerId:e}))))),[])}}class l extends Error{constructor({reason:e,namespace:t,errorKey:n,details:r}){super(`ConnectError with error key "${n}"`),this.errorType=l.ErrorType,this.namespace=t,this.errorKey=n,this.reason=e,this.details=null!=r?r:{}}}l.ErrorType="ConnectError";class u{constructor(e){this.requestMap=new Map,this.logger=new x({provider:e,source:"core.requestManager"})}processRequest(e){const{requestId:t}=e;return function(e,t,n,r){const o=Math.max(1,null!=r?r:3e4);return new Promise(((r,i)=>{let s=!1;const a=setTimeout((()=>{n({timeoutMs:o,request:e}),i(function(e,t){const{namespace:n,command:r,data:o}=e;return{namespace:n,reason:"Client Timeout",details:{command:r,requestData:o,timeoutMs:t},errorKey:"clientTimeout"}}(e,o)),s=!0}),o);t((e=>{clearTimeout(a),s||(e.isError?i(new l(e)):r(e.data))}))}))}(e,(e=>this.requestMap.set(t,e)),(({request:e,timeoutMs:t})=>this.handleTimeout(e,t)))}processResponse(e){const{requestId:t}=e,n=this.requestMap.get(t);n?(n(e),this.requestMap.delete(t)):this.logger.error("Returned a response message with no handler",{message:e})}handleTimeout(e,t){const{requestId:n,namespace:r,command:o}=e;this.requestMap.delete(n),this.logger.error("Client request timeout",{requestId:n,namespace:r,command:o,timeoutMs:t})}}var d=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n};function h(e){try{switch(e.type){case"acknowledge":case"error":case"childConnectionClose":default:return e;case"childDownstreamMessage":return Object.assign(Object.assign({},e),{message:h(e.message)});case"publish":{const{data:t}=e,n=d(e,["data"]);return Object.assign({},n)}case"response":if(e.isError)return Object.assign(Object.assign({},e),{details:{command:e.details.command}});{const{data:t}=e,n=d(e,["data"]);return Object.assign({},n)}}}catch(t){return{messageDetails:"error when sanitizing downstream message",message:e,error:t}}}class p{constructor(e,t){this.provider=e,this.relayChildUpstreamMessage=t,this.messagePorts=new Map,this.logger=new x({provider:e,source:"childConnectionManager"})}addChannel({connectionId:e,port:t,providerId:n}){if(this.messagePorts.has(e))return void this.logger.error("Attempted to add child connection that already exists. No action",{connectionId:e});const r=this.createMessageHandler(e,n);t.addEventListener("message",r),t.start(),this.messagePorts.set(e,{port:t,handler:r,providerId:n}),this.relayChildUpstreamMessage({type:"childUpstream",connectionId:e,sourceProviderId:n,parentProviderId:this.provider.id,message:{type:"childConnectionReady"}}),this.logger.debug("Child port added",{connectionId:e})}handleDownstreamMessage({connectionId:e,message:t,targetProviderId:n}){const r=this.messagePorts.get(e);if(!r)return void this.logger.warn("Attempted to route downstream message to child message port that does not exist",{connectionId:e,message:h(t)});const{port:o,providerId:i}=r;i&&i!==n?this.logger.error("Downstream target message did not match target provider id. Not sending message.",{connectionId:e,targetProviderId:n,actualProviderId:i,message:h(t)}):o.postMessage(t)}handleCloseMessage({connectionId:e}){const t=this.messagePorts.get(e);if(!t)return void this.logger.warn("Attempted to close child message port that was not found",{connectionId:e});const{port:n,handler:r}=t;n.removeEventListener("message",r),n.close(),this.messagePorts.delete(e),this.logger.debug("Removed child message channel",{connectionId:e})}createMessageHandler(e,t){return n=>this.relayChildUpstreamMessage({type:"childUpstream",sourceProviderId:t,parentProviderId:this.provider.id,connectionId:e,message:n.data})}}class g{constructor(e){this.errorHandlers=new Set,this.logger=new x({provider:e,source:"core.proxy.error"})}invoke(e){const{message:t,key:n,details:r,isFatal:o,connectionStatus:i}=e;this.logger.error(t,{key:n,details:r,isFatal:o,connectionStatus:i},{duplicateMessageToConsole:!0,remoteIgnore:!0}),[...this.errorHandlers].forEach((t=>{try{t(e)}catch(t){this.logger.error("An error occurred within a AmazonConnectErrorHandler",{handlerError:t,originalError:e})}}))}onError(e){this.errorHandlers.add(e)}offError(e){this.errorHandlers.delete(e)}}class f{constructor(e){this.status="notConnected",this.changeHandlers=new Set,this.logger=new x({source:"core.proxy.connection-status-manager",provider:e,mixin:()=>({status:this.status})})}getStatus(){return this.status}update(e){this.status=e.status,this.logger.trace("Proxy Connection Status Changed",{status:e.status}),[...this.changeHandlers].forEach((t=>{try{t(e)}catch(e){this.logger.error("An error occurred within a ProxyConnectionChangedHandler",{error:e})}}))}onChange(e){this.changeHandlers.add(e)}offChange(e){this.changeHandlers.delete(e)}}var m;class y{constructor(e){this.provider=e,this.logger=new x({source:"core.proxy",provider:e,mixin:()=>({proxyType:this.proxyType,connectionId:this.connectionId})}),this.requestManager=new u(e),this.status=new f(e),this.errorService=new g(e),this.upstreamMessageQueue=[],this.connectionEstablished=!1,this.isInitialized=!1,this.subscriptions=new c,this.connectionId=null,this.channelManager=new p(e,this.sendOrQueueMessageToSubject.bind(this))}init(){if(this.isInitialized)throw new Error("Proxy already initialized");this.isInitialized=!0,this.initProxy()}request(e,t,n,r){const o=function(e,t,n,r){return{type:"request",namespace:e,command:t,requestId:i(),data:n,messageOrigin:r}}(e,t,n,null!=r?r:this.getUpstreamMessageOrigin()),s=this.requestManager.processRequest(o);return this.sendOrQueueMessageToSubject(o),s}subscribe(e,t,n){const{handlerId:r}=this.subscriptions.add(e,t),o={type:"subscribe",topic:e,messageOrigin:null!=n?n:this.getUpstreamMessageOrigin(),handlerId:r};this.sendOrQueueMessageToSubject(o)}unsubscribe(e,t,n){if(this.subscriptions.delete(e,t),this.subscriptions.isEmpty(e)){const t={type:"unsubscribe",topic:e,messageOrigin:null!=n?n:this.getUpstreamMessageOrigin()};this.sendOrQueueMessageToSubject(t)}}log(e){const t=function({level:e,source:t,message:n,loggerId:r,data:o},i,s){const a=o?JSON.parse(JSON.stringify(o)):void 0;return{type:"log",level:e,time:new Date,source:t,message:n,loggerId:r,data:a,context:i,messageOrigin:s}}(e,this.addContextToLogger(),this.getUpstreamMessageOrigin());this.sendOrQueueMessageToSubject(t)}sendLogMessage(e){"log"===e.type?(e.context=Object.assign(Object.assign({},e.context),this.addContextToLogger()),this.sendOrQueueMessageToSubject(e)):this.logger.error("Attempted to send invalid log message",{message:e})}sendMetric({metricData:e,time:t,namespace:n}){const r=function({metricData:e,time:t,namespace:n},r){var o,i;return{type:"metric",namespace:n,metricName:e.metricName,unit:e.unit,value:e.value,time:t,dimensions:null!==(o=e.dimensions)&&void 0!==o?o:{},optionalDimensions:null!==(i=e.optionalDimensions)&&void 0!==i?i:{},messageOrigin:r}}({metricData:e,time:t,namespace:n},this.getUpstreamMessageOrigin());this.sendOrQueueMessageToSubject(r)}sendMetricMessage(e){"metric"===e.type?this.sendOrQueueMessageToSubject(e):this.logger.error("Attempted to send invalid metric message",{metricMessage:e})}sendOrQueueMessageToSubject(e){this.connectionEstablished?this.sendMessageToSubject(e):this.upstreamMessageQueue.push(e)}consumerMessageHandler(e){if(!this.isInitialized)return void this.logger.error("Attempted to process message from subject prior to proxy being initializing. Message not processed",{originalMessageEventData:e.data});const{data:t}=e;if(!("type"in t))return void this.logger.warn("Unknown inbound message",{originalMessageEventData:t});const n=t;this.handleMessageFromSubject(n)}handleMessageFromSubject(e){this.handleDefaultMessageFromSubject(e)}handleDefaultMessageFromSubject(e){switch(e.type){case"acknowledge":this.handleConnectionAcknowledge(e);break;case"response":this.handleResponse(e);break;case"publish":this.handlePublish(e);break;case"error":this.handleError(e);break;case"childDownstreamMessage":this.channelManager.handleDownstreamMessage(e);break;case"childConnectionClose":this.channelManager.handleCloseMessage(e);break;default:return void this.logger.error("Unknown inbound message",{originalMessageEventData:e})}}handleConnectionAcknowledge(e){for(this.connectionId=e.connectionId,this.status.update({status:"ready",connectionId:e.connectionId}),this.connectionEstablished=!0;this.upstreamMessageQueue.length;){const e=this.upstreamMessageQueue.shift();this.sendMessageToSubject(e)}}handleResponse(e){this.requestManager.processResponse(e)}handlePublish(e){const{handlerId:t,topic:n}=e;if(t){const r=this.subscriptions.getById(n,t);r&&this.handleAsyncSubscriptionHandlerInvoke({handler:r,handlerId:t},e)}else this.subscriptions.get(n).map((t=>{this.handleAsyncSubscriptionHandlerInvoke(t,e)}))}handleError(e){if(e.isFatal){const{message:t,type:n}=e,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n}(e,["message","type"]);this.status.update({status:"error",reason:t,details:r})}this.publishError({message:e.message,key:e.key,details:e.details,isFatal:e.isFatal,proxyStatus:e.status})}publishError(e){const t=Object.assign(Object.assign({},e),{connectionStatus:this.connectionStatus});this.errorService.invoke(t)}handleAsyncSubscriptionHandlerInvoke(e,t){return n=this,r=arguments,i=function*({handler:e,handlerId:t},{topic:n,data:r}){try{yield e(r)}catch(e){this.logger.error("An error occurred when handling subscription",{topic:n,error:e,handlerId:t})}},new((o=void 0)||(o=Promise))((function(e,t){function s(e){try{c(i.next(e))}catch(e){t(e)}}function a(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(s,a)}c((i=i.apply(n,r||[])).next())}));var n,r,o,i}get connectionStatus(){return this.status.getStatus()}onError(e){this.errorService.onError(e)}offError(e){this.errorService.offError(e)}onConnectionStatusChange(e){this.status.onChange(e)}offConnectionStatusChange(e){this.status.offChange(e)}addChildChannel(e){this.channelManager.addChannel(e)}resetConnection(e){var t;this.connectionEstablished=!1,this.status.update({status:"reset",reason:e});const n=this.subscriptions.getAllSubscriptionHandlerIds();this.logger.info("Resetting proxy",{reason:e,subscriptionHandlerCount:null!==(t=null==n?void 0:n.length)&&void 0!==t?t:-1}),null==n||n.map((({topic:e,handlerId:t})=>({type:"subscribe",topic:e,messageOrigin:this.getUpstreamMessageOrigin(),handlerId:t}))).forEach((e=>this.sendOrQueueMessageToSubject(e)))}}class v{constructor(e,t){this.timeoutMs=t,this.onCancelled=e,this.timeout=setTimeout((()=>this.handleCancel()),this.timeoutMs),this.status="running",this.logger=new x({source:"core.utility.timeout-tracker",mixin:()=>({timeoutMs:this.timeoutMs,timeoutTrackerStatus:this.status})})}static start(e,t){return new v(e,t)}complete(){switch(this.status){case"running":return this.handleComplete();case"completed":return this.logger.debug("TimeoutTracker already marked complete. No action."),!0;case"cancelled":return this.logger.info("Attempted to complete a TimeoutTracker that has already been cancelled"),!1}}isCancelled(){return"cancelled"===this.status}getStatus(){return this.status}handleCancel(){switch(this.status){case"running":this.status="cancelled",this.logger.info("TimeoutTracker has timed out. Invoking onCancelled Handler"),this.invokeOnCancelled();break;case"completed":this.logger.debug("Cancel operation for TimerTracker invoked after already completed. No action.");break;default:throw new Error("Cancel operation in TimerTracker called during an unexpected time.")}}handleComplete(){return this.status="completed",clearTimeout(this.timeout),!0}invokeOnCancelled(){try{this.onCancelled({timeoutMs:this.timeoutMs})}catch(e){this.logger.error("Error when attempting to invoke TimeoutTrackerCancelledHandler",{error:e})}}}class b{constructor({config:e,proxyFactory:t}){if(this._id=i(),!t)throw new Error("Attempted to get Proxy before setting up factory");if(!e)throw new Error("Failed to include config");this.proxyFactory=t,this._config=e}get id(){return this._id}getProxy(){return this.proxy||(this.proxy=this.proxyFactory(this),this.proxy.init()),this.proxy}get config(){return Object.assign({},this._config)}onError(e){this.getProxy().onError(e)}offError(e){this.getProxy().offError(e)}static initializeProvider(e){const t=new x({source:"core.amazonConnect.init",provider:e});if(this.isInitialized){const e="Error: Attempted to initialize provider more than one time.";throw t.error(e),new Error(e)}return function(e){if(r)throw new Error("Global Provider is already set");r=e}(e),this.isInitialized=!0,e.getProxy(),e}}b.isInitialized=!1,function(e){e[e.trace=1]="trace",e[e.debug=2]="debug",e[e.info=3]="info",e[e.warn=4]="warn",e[e.error=5]="error"}(m||(m={}));class w{constructor(e){this.mixin=e}getTransformedData(e,t){return this.mixin?Object.assign(Object.assign({},null!=t?t:{}),this.mixin(null!=t?t:{},e)):t}}class x{constructor(e){this._proxy=null,this._logToConsoleLevel=null,this.loggerId=function(){const e=new Uint8Array(Math.ceil(4));return crypto.getRandomValues(e),Array.from(e,(e=>e.toString(16).padStart(2,"0"))).join("").substring(0,8)}(),"string"==typeof e?(this.source=e,this.dataTransformer=new w(void 0)):(this.source=e.source,e.provider&&"function"==typeof e.provider?this.providerFactory=e.provider:this.provider=e.provider,this.dataTransformer=new w(e.mixin),this.logOptions=e.options)}trace(e,t,n){this.log(m.trace,e,t,n)}debug(e,t,n){this.log(m.debug,e,t,n)}info(e,t,n){this.log(m.info,e,t,n)}warn(e,t,n){this.log(m.warn,e,t,n)}error(e,t,n){this.log(m.error,e,t,n)}log(e,t,n,r){const o=this.dataTransformer.getTransformedData(e,n);this.ignoreRemote(r)||this.getProxy().log({level:e,source:this.source,loggerId:this.loggerId,message:t,data:o}),this.applyDuplicateMessageToConsole(e,r)&&function(e,t,n){if(n)switch(e){case m.error:console.error(t,n);break;case m.warn:console.warn(t,n);break;case m.info:console.info(t,n);break;case m.debug:console.debug(t,n);break;case m.trace:console.trace(t,n);break;default:console.log(t,n)}else switch(e){case m.error:console.error(t);break;case m.warn:console.warn(t);break;case m.info:console.info(t);break;case m.debug:console.debug(t);break;case m.trace:console.trace(t);break;default:console.log(t)}}(e,t,o)}getProvider(){return this.provider||(this.provider=this.providerFactory?this.providerFactory():o()),this.provider}getProxy(){return this._proxy||(this._proxy=this.getProvider().getProxy()),this._proxy}applyDuplicateMessageToConsole(e,t){return(null==t?void 0:t.duplicateMessageToConsole)||this.getLogConsoleLevel()<=e}getLogConsoleLevel(){var e,t,n,r;return this._logToConsoleLevel||(this._logToConsoleLevel=(null===(e=this.logOptions)||void 0===e?void 0:e.minLogToConsoleLevelOverride)?this.logOptions.minLogToConsoleLevelOverride:null!==(r=null===(n=null===(t=this.getProvider().config)||void 0===t?void 0:t.logging)||void 0===n?void 0:n.minLogToConsoleLevel)&&void 0!==r?r:m.error),this._logToConsoleLevel}ignoreRemote(e){var t,n,r;return null!==(n=null===(t=this.logOptions)||void 0===t?void 0:t.remoteIgnore)&&void 0!==n&&n||null!==(r=null==e?void 0:e.remoteIgnore)&&void 0!==r&&r}}class I{constructor(e,t){this.engineContext=e,this.moduleNamespace=t}get proxy(){if(!this.moduleProxy){const e=this.engineContext.getProxy(),t=this.moduleNamespace;this.moduleProxy=function(e,t){return{request:(n,r)=>e.request(t,n,r),subscribe:(n,r)=>e.subscribe(Object.assign(Object.assign({},n),{namespace:t}),r),unsubscribe:(n,r)=>e.unsubscribe(Object.assign(Object.assign({},n),{namespace:t}),r),getProxyInfo:()=>({connectionStatus:e.connectionStatus,proxyType:e.proxyType}),onConnectionStatusChange:t=>e.onConnectionStatusChange(t),offConnectionStatusChange:t=>e.offConnectionStatusChange(t)}}(e,t)}return this.moduleProxy}createLogger(e){return this.engineContext.createLogger(e)}}class C{constructor(e){this.provider=e}getProxy(){return this.getProvider().getProxy()}getModuleContext(e){return new I(this,e)}getProvider(){return this.provider?this.provider:o()}createLogger(e){return new x("object"==typeof e?Object.assign(Object.assign({},e),{provider:()=>this.getProvider()}):{source:e,provider:()=>this.getProvider()})}}class S{constructor(e,t){var n;this.namespace=e,this.context=null!==(n=null==t?void 0:t.context)&&void 0!==n?n:new C(null==t?void 0:t.provider).getModuleContext(e)}}class k extends C{constructor(e,t,n,r){super(e),this.appInstanceId=t,this.appConfig=n,this.contactScope=r}}var E,M=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class O{constructor(e){this.provider=e,this.startHandlers=new Set,this.stopHandlers=new Set,this.state={isRunning:!1},this.isCreated=!1,this.isDestroyed=!1,this.logger=new x({source:"app.lifecycleManager",provider:e,mixin:()=>({state:this.state,isCreated:this.isCreated,isDestroyed:this.isDestroyed})})}handleLifecycleChangeMessage(e){const t=new k(this.provider,e.appInstanceId,e.appConfig,e.contactScope);this.state.appInstanceId=e.appInstanceId,this.state.appConfig=e.appConfig,this.state.contactScope=e.contactScope;const n={context:t};switch(e.stage){case"create":return this.handleCreate(n);case"start":return this.handleStart(n);case"stop":return this.handleStop(n);case"destroy":return this.handleDestroy(n)}}onStart(e,t){this.startHandlers.add(e),(null==t?void 0:t.invokeIfRunning)&&this.state.isRunning&&this.handleLifecycleChange(Object.assign(Object.assign({},this.getLifecycleChangeParams()),{stage:"start"}),(t=>e(t)),!1)}onStop(e){this.stopHandlers.add(e)}offStart(e){this.startHandlers.delete(e)}offStop(e){this.stopHandlers.delete(e)}get appState(){return Object.assign({},this.state)}handleCreate(e){return M(this,void 0,void 0,(function*(){var t;if(this.isDestroyed)return void this.logger.error("An attempt was Create after a Destroy. No Action",{appInstanceId:e.context.appInstanceId});if(this.isCreated)return void this.logger.error("An attempt was invoke Create after it was already invoked. No Action",{appInstanceId:e.context.appInstanceId});if(this.logger.debug("Begin Lifecycle Create",{appInstanceId:e.context.appInstanceId}),!(null===(t=this.provider.config)||void 0===t?void 0:t.onCreate)){const t="App did not specify an onCreated handler. This is required. Closing app",n={appInstanceId:e.context.appInstanceId};return this.logger.error(t,{appInstanceId:e.context.appInstanceId}),void this.provider.sendFatalError(t,n)}const{success:n}=yield this.handleLifecycleChange(Object.assign(Object.assign({},e),{stage:"create"}),(e=>this.provider.config.onCreate(e)),!0);n&&(this.isCreated=!0,this.sendLifecycleHandlerCompletedMessage(e.context.appInstanceId,"create"))}))}handleStart(e){return M(this,void 0,void 0,(function*(){if(this.isDestroyed)return void this.logger.error("An attempt was Start after a Destroy. No Action",{appInstanceId:e.context.appInstanceId});if(!this.isCreated)return void this.logger.error("An attempt was invoke Start before Create. No Action",{appInstanceId:e.context.appInstanceId});this.state.isRunning=!0,this.logger.info("Begin Lifecycle Start");const t=yield Promise.all([...this.startHandlers].map((t=>this.handleLifecycleChange(Object.assign(Object.assign({},e),{stage:"start"}),(e=>t(e)),!1))));this.logger.debug("Completed all start handlers",{count:this.startHandlers.size,errorCount:t.filter((({success:e})=>!e)).length})}))}handleStop(e){return M(this,void 0,void 0,(function*(){if(this.isDestroyed)return void this.logger.error("An attempt was Stop after a Destroy. No Action",{appInstanceId:e.context.appInstanceId});if(!this.isCreated)return void this.logger.error("An attempt was invoke Stop before Create. No Action",{appInstanceId:e.context.appInstanceId});this.state.isRunning=!1,this.logger.info("Begin Lifecycle Stop");const t=yield Promise.all([...this.stopHandlers].map((t=>this.handleLifecycleChange(Object.assign(Object.assign({},e),{stage:"stop"}),(e=>t(e)),!1))));this.logger.debug("Completed all stop handlers",{count:this.stopHandlers.size,errorCount:t.filter((({success:e})=>!e)).length})}))}handleDestroy(e){return M(this,void 0,void 0,(function*(){if(this.isDestroyed)return void this.logger.error("An attempt was invoke Destroy multiple times. No Action",{appInstanceId:e.context.appInstanceId});if(!this.isCreated)return void this.logger.error("An attempt was invoke Destroy before Create. No Action",{appInstanceId:e.context.appInstanceId});this.isDestroyed=!0,this.state.isRunning=!1,this.logger.info("Begin Lifecycle Destroy");const{config:t}=this.provider,{success:n}=yield this.handleLifecycleChange(Object.assign(Object.assign({},e),{stage:"destroy"}),(e=>t.onDestroy?t.onDestroy(e):Promise.resolve()),!0);n&&this.sendLifecycleHandlerCompletedMessage(e.context.appInstanceId,"destroy")}))}handleLifecycleChange(e,t,n){return M(this,void 0,void 0,(function*(){let r=!1;try{yield t(e),r=!0}catch(t){const{appInstanceId:r}=e.context;if(n){const n=`An fatal error occurred when handling a ${e.stage} lifecycle action. Closing app`;this.logger.error(n,{appInstanceId:r,error:t}),this.provider.sendFatalError(n,t)}else this.logger.error(`An error occurred when handling a ${e.stage} lifecycle action.`,{appInstanceId:r,error:t})}return{success:r}}))}getLifecycleChangeParams(){return{context:new k(this.provider,this.state.appInstanceId,this.state.appConfig,this.state.contactScope)}}sendLifecycleHandlerCompletedMessage(e,t){this.logger.debug(`Sending lifecycle ${t} completed signal`),this.provider.getProxy().sendLifecycleHandlerCompleted(e,t)}}class L extends y{constructor(e,t){super(e),this.channel=new MessageChannel,this.lifecycleManager=t,this.appLogger=new x({source:"app.appProxy",provider:e})}get proxyType(){return"AppProxy"}sendLifecycleHandlerCompleted(e,t){const n={type:"appLifecycleHandlerCompleted",stage:t,appInstanceId:e};this.sendOrQueueMessageToSubject(n)}tryCloseApp(e,t,n){const r={type:"closeApp",isFatalError:null!=t&&t,message:e,data:n};this.sendOrQueueMessageToSubject(r)}publish(e,t){const n={type:"appPublish",topic:e,data:t};this.sendOrQueueMessageToSubject(n)}initProxy(){const e={type:"connect-app-host-init",sdkVersion:"1.0.4",providerId:this.provider.id};var t,n,r;this.status.update({status:"initializing"}),this.channel.port1.onmessage=e=>this.consumerMessageHandler(e),this.connectionTimer=v.start(this.connectionTimeout.bind(this),(t=this.provider.config,Math.max(1,Math.min(6e4,null!==(r=null===(n=t.workspace)||void 0===n?void 0:n.connectionTimeout)&&void 0!==r?r:5e3)))),window.parent.postMessage(e,"*",[this.channel.port2]),this.appLogger.debug("Send connect message to configure proxy")}sendMessageToSubject(e){this.channel.port1.postMessage(e)}getUpstreamMessageOrigin(){if(null===document||void 0===document?void 0:document.location){const{origin:e,pathname:t}=document.location;return{_type:"app",providerId:this.provider.id,origin:e,path:t}}return{_type:"app",providerId:this.provider.id,origin:"unknown",path:"unknown"}}handleConnectionAcknowledge(e){this.connectionTimer.complete()?super.handleConnectionAcknowledge(e):this.appLogger.error("Workspace connection acknowledge received after timeout. App is not connected to workspace.",{timeout:this.connectionTimer.timeoutMs})}handleMessageFromSubject(e){"appLifecycle"===e.type?this.lifecycleManager.handleLifecycleChangeMessage(e).catch((e=>{this.appLogger.error("An error occurred when invoking handleLifecycleChangeMessage",{error:e})})):super.handleMessageFromSubject(e)}connectionTimeout(e){this.status.update({status:"error",reason:"Workspace connection timeout",details:Object.assign({},e)}),this.publishError({message:"App failed to connect to workspace in the allotted time",key:"workspaceConnectTimeout",details:Object.assign({},e),isFatal:!0,proxyStatus:{initialized:!1}})}addContextToLogger(){const{isRunning:e}=this.lifecycleManager.appState;if(null===document||void 0===document?void 0:document.location){const{origin:t,pathname:n}=document.location;return{appIsRunning:e,app:{origin:t,path:n}}}return{appIsRunning:e,app:{origin:"unknown",path:"unknown"}}}}class A extends b{constructor(e){super({config:e,proxyFactory:()=>this.createProxy()}),this.lifecycleManager=new O(this),this.logger=new x({provider:this,source:"app.provider"})}static init(e){const t=new A(e);return A.initializeProvider(t),{provider:t}}static get default(){return o("AmazonConnectApp has not been initialized")}createProxy(){return new L(this,this.lifecycleManager)}onStart(e,t){this.lifecycleManager.onStart(e,t)}onStop(e){this.lifecycleManager.onStop(e)}offStart(e){this.lifecycleManager.offStart(e)}offStop(e){this.lifecycleManager.offStop(e)}sendCloseAppRequest(e){this.getProxy().tryCloseApp(e,!1)}sendError(e,t){this.logger.error(e,t)}sendFatalError(e,t){this.getProxy().tryCloseApp(e,!0,t)}subscribe(e,t){this.getProxy().subscribe(e,t)}unsubscribe(e,t){this.getProxy().unsubscribe(e,t)}publish(e,t){this.getProxy().publish(e,t)}}!function(e){e.CurrentContactId="CURRENT_CONTACT"}(E||(E={}));var T,P,j,N;!function(e){e.getARN="agent/getARN",e.getName="agent/getName",e.getState="agent/getState",e.getRoutingProfile="agent/getRoutingProfile",e.getChannelConcurrency="agent/getChannelConcurrency",e.getExtension="agent/getExtension",e.getDialableCountries="agent/getDialableCountries"}(T||(T={})),function(e){e.getAttributes="contact/getAttributes",e.getInitialContactId="contact/getInitialContactId",e.getType="contact/getType",e.getStateDuration="contact/getStateDuration",e.getQueue="contact/getQueue",e.getQueueTimestamp="contact/getQueueTimestamp",e.getDescription="contact/getDescription",e.getReferences="contact/getReferences"}(P||(P={})),function(e){e.StartingACW="contact/acw",e.Connected="contact/connected",e.Destroyed="contact/destroy",e.Missed="contact/missed"}(j||(j={})),function(e){e.StateChanged="agent/stateChange"}(N||(N={}));var D=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{c(r.next(e))}catch(e){i(e)}}function a(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}c((r=r.apply(e,t||[])).next())}))};class H extends S{constructor(e){super("aws.connect.contact",e)}getARN(){return D(this,void 0,void 0,(function*(){const{ARN:e}=yield this.context.proxy.request(T.getARN);return e}))}getName(){return D(this,void 0,void 0,(function*(){const{name:e}=yield this.context.proxy.request(T.getName);return e}))}getState(){return this.context.proxy.request(T.getState)}getRoutingProfile(){return this.context.proxy.request(T.getRoutingProfile)}getChannelConcurrency(){return this.context.proxy.request(T.getChannelConcurrency)}getExtension(){return D(this,void 0,void 0,(function*(){const{extension:e}=yield this.context.proxy.request(T.getExtension);return e}))}getDialableCountries(){return D(this,void 0,void 0,(function*(){const{dialableCountries:e}=yield this.context.proxy.request(T.getDialableCountries);return e}))}onStateChanged(e){this.context.proxy.subscribe({key:N.StateChanged},e)}offStateChanged(e){this.context.proxy.unsubscribe({key:N.StateChanged},e)}}function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function R(){R=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,s=Object.create(i.prototype),a=new A(r||[]);return o(s,"_invoke",{value:E(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",g="executing",f="completed",m={};function y(){}function v(){}function b(){}var w={};l(w,s,(function(){return this}));var x=Object.getPrototypeOf,I=x&&x(x(T([])));I&&I!==n&&r.call(I,s)&&(w=I);var C=b.prototype=y.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,s,a){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==q(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function E(t,n,r){var o=h;return function(i,s){if(o===g)throw Error("Generator is already running");if(o===f){if("throw"===i)throw s;return{value:e,done:!0}}for(r.method=i,r.arg=s;;){var a=r.delegate;if(a){var c=M(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?f:p,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=f,r.method="throw",r.arg=l.arg)}}}function M(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,M(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(q(t)+" is not iterable")}return v.prototype=b,o(C,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},S(k.prototype),l(k.prototype,a,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var s=new k(u(e,n,r,o),i);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(C),l(C,c,"Generator"),l(C,s,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return a.type="throw",a.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}function _(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function z(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){_(i,r,o,s,a,"next",e)}function a(e){_(i,r,o,s,a,"throw",e)}s(void 0)}))}}var F=null;function B(){return U.apply(this,arguments)}function U(){return(U=z(R().mark((function e(){var t,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,A.init({onCreate:function(e){var t=e.context.appInstanceId;console.log("App initialized: ",t)},onDestroy:function(e){console.log("App being destroyed")}});case 3:return t=e.sent,n=t.provider,F=new H,e.abrupt("return",n);case 10:throw e.prev=10,e.t0=e.catch(0),console.error("Error initializing Connect:",e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[0,10]])})))).apply(this,arguments)}function Q(){return G.apply(this,arguments)}function G(){return(G=z(R().mark((function e(){var t,n;return R().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,F){e.next=3;break}throw new Error("Agent client is not available");case 3:return e.next=5,F.getARN();case 5:return t=e.sent,e.next=8,F.getName();case 8:if(n=e.sent,t){e.next=11;break}throw new Error("Agent ARN is not available");case 11:return e.abrupt("return",{agentArn:t,agentName:n||"Unknown Agent"});case 14:throw e.prev=14,e.t0=e.catch(0),console.error("Error getting agent ARN:",e.t0),new Error(e.t0.message||"Failed to get agent information");case 18:case"end":return e.stop()}}),e,null,[[0,14]])})))).apply(this,arguments)}var W=n(72),J=n.n(W),V=n(825),Y=n.n(V),$=n(659),K=n.n($),X=n(56),Z=n.n(X),ee=n(540),te=n.n(ee),ne=n(113),re=n.n(ne),oe=n(159),ie={};function se(e){return se="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},se(e)}function ae(){ae=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},s=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(e){l=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof y?t:y,s=Object.create(i.prototype),a=new A(r||[]);return o(s,"_invoke",{value:E(e,n,a)}),s}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",g="executing",f="completed",m={};function y(){}function v(){}function b(){}var w={};l(w,s,(function(){return this}));var x=Object.getPrototypeOf,I=x&&x(x(T([])));I&&I!==n&&r.call(I,s)&&(w=I);var C=b.prototype=y.prototype=Object.create(w);function S(e){["next","throw","return"].forEach((function(t){l(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){function n(o,i,s,a){var c=d(e[o],e,i);if("throw"!==c.type){var l=c.arg,u=l.value;return u&&"object"==se(u)&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,s,a)}),(function(e){n("throw",e,s,a)})):t.resolve(u).then((function(e){l.value=e,s(l)}),(function(e){return n("throw",e,s,a)}))}a(c.arg)}var i;o(this,"_invoke",{value:function(e,r){function o(){return new t((function(t,o){n(e,r,t,o)}))}return i=i?i.then(o,o):o()}})}function E(t,n,r){var o=h;return function(i,s){if(o===g)throw Error("Generator is already running");if(o===f){if("throw"===i)throw s;return{value:e,done:!0}}for(r.method=i,r.arg=s;;){var a=r.delegate;if(a){var c=M(a,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===h)throw o=f,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=g;var l=d(t,n,r);if("normal"===l.type){if(o=r.done?f:p,l.arg===m)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o=f,r.method="throw",r.arg=l.arg)}}}function M(t,n){var r=n.method,o=t.iterator[r];if(o===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,M(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var i=d(o,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var s=i.arg;return s?s.done?(n[t.resultName]=s.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function O(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function L(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function A(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(O,this),this.reset(!0)}function T(t){if(t||""===t){var n=t[s];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,i=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(se(t)+" is not iterable")}return v.prototype=b,o(C,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:v,configurable:!0}),v.displayName=l(b,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===v||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,l(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},S(k.prototype),l(k.prototype,a,(function(){return this})),t.AsyncIterator=k,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var s=new k(u(e,n,r,o),i);return t.isGeneratorFunction(n)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},S(C),l(C,c,"Generator"),l(C,s,(function(){return this})),l(C,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=T,A.prototype={constructor:A,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(L),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return a.type="throw",a.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return o("end");if(s.tryLoc<=this.prev){var c=r.call(s,"catchLoc"),l=r.call(s,"finallyLoc");if(c&&l){if(this.prev<s.catchLoc)return o(s.catchLoc,!0);if(this.prev<s.finallyLoc)return o(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return o(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return o(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=e,s.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),L(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var o=r.arg;L(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:T(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}function ce(e,t,n,r,o,i,s){try{var a=e[i](s),c=a.value}catch(e){return void n(e)}a.done?t(c):Promise.resolve(c).then(r,o)}function le(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function s(e){ce(i,r,o,s,a,"next",e)}function a(e){ce(i,r,o,s,a,"throw",e)}s(void 0)}))}}ie.styleTagTransform=re(),ie.setAttributes=Z(),ie.insert=K().bind(null,"head"),ie.domAPI=Y(),ie.insertStyleElement=te(),J()(oe.A,ie),oe.A&&oe.A.locals&&oe.A.locals;var ue,de,he="https://9hzdqlh76b.execute-api.us-east-1.amazonaws.com/prod/queue",pe=!1,ge=new Set;function fe(){return(fe=le(ae().mark((function e(){return ae().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,B();case 3:Me(),Oe(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Failed to initialize Connect:",e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function me(){return ye.apply(this,arguments)}function ye(){return(ye=le(ae().mark((function e(){var t,n;return ae().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!pe){e.next=3;break}return e.abrupt("return");case 3:return be(!0),e.next=6,fetch(he);case 6:if((t=e.sent).ok){e.next=9;break}throw new Error("HTTP error! status: ".concat(t.status));case 9:return e.next=11,t.json();case 11:n=e.sent,we(ve(n.sort((function(e,t){return e.startTimeRAW-t.startTimeRAW})))),e.next=22;break;case 17:e.prev=17,e.t0=e.catch(0),console.error("Error fetching data:",e.t0),Se(e.t0.message||"An unexpected error occurred");case 22:return e.prev=22,be(!1),e.finish(22);case 25:case"end":return e.stop()}}),e,null,[[0,17,22,25]])})))).apply(this,arguments)}function ve(e){var t=document.getElementById("queue-filter").value.toLowerCase(),n=document.getElementById("no-agent-filter").checked;return e.filter((function(e){var r,o,i,s=!t||(null===(r=e.Queue)||void 0===r?void 0:r.toLowerCase().includes(t)),a=!n||!e.Agent,c=(null===(o=e.ANI)||void 0===o?void 0:o.trim())||(null===(i=e.DNIS)||void 0===i?void 0:i.trim());return s&&a&&c}))}function be(e){var t=document.getElementById("refresh-button");e?(t.classList.add("loading"),t.textContent="Refreshing...",t.disabled=!0):(t.classList.remove("loading"),t.textContent="Refresh the page",t.disabled=!1)}function we(e){var t=document.querySelector("#queue-table tbody");t.innerHTML="",e.forEach((function(e){var n=function(e){var t=document.createElement("tr"),n=!e.Agent;t.innerHTML='\n        <td><a href="'.concat(e.ContactDetails,'" target="_blank">').concat(e.ContactID,"</a></td>\n        <td>").concat(e.ANI||"","</td>\n        <td>").concat(e.Queue||"","</td>\n        <td>").concat(e.startTime||"","</td>\n         <td>").concat(e.Agent||"",'</td>\n        <td><input type="checkbox" class="select-contact" data-contact-id="').concat(e.ContactID,'"></td>\n        <td>\n            <button class="pick-btn ').concat(n?"":"disabled",'"\n                    data-contact-id="').concat(e.ContactID,'"\n                    ').concat(n?"":"disabled",">\n                Pick\n            </button>\n        </td>\n    ");var r=t.querySelector(".pick-btn");return r&&r.addEventListener("click",Ie),t}(e);t.appendChild(n);var r=n.querySelector(".select-contact");if(r&&ge.has(e.ContactID)){r.checked=!0;var o=n.querySelector(".pick-btn");o&&(o.style.display="inline-block")}})),document.querySelectorAll(".select-contact").forEach((function(e){e.addEventListener("change",xe)}))}function xe(e){var t=e.target.getAttribute("data-contact-id"),n=document.querySelector('button[data-contact-id="'.concat(t,'"]'));n&&(e.target.checked?(ge.add(t),n.style.display="inline-block"):(ge.delete(t),n.style.display="none"))}function Ie(e){return Ce.apply(this,arguments)}function Ce(){return(Ce=le(ae().mark((function e(t){var n,r,o,i,s;return ae().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.target.disabled){e.next=3;break}return Se("Contacts with agents cannot be picked"),e.abrupt("return");case 3:return e.prev=3,document.getElementById("loader-container").style.display="block",document.getElementById("overlay").style.display="block",n=t.target.getAttribute("data-contact-id"),e.next=9,Q();case 9:return r=e.sent,o=r.agentArn,i=r.agentName,e.next=14,fetch(he,{method:"POST",headers:{"Content-Type":"application/json"},mode:"cors",body:JSON.stringify({ContactID:n,AgentARN:o,AgentName:i})});case 14:if(!(s=e.sent).ok){e.next=21;break}ge.delete(n),Se("Contact picked successfully!"),me(),e.next=22;break;case 21:throw new Error("HTTP error! status: ".concat(s.status));case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(3),console.error("Error picking contact:",e.t0),Se("Oh No! There was an error picking the contact.");case 28:return e.prev=28,document.getElementById("loader-container").style.display="none",document.getElementById("overlay").style.display="none",e.finish(28);case 32:case"end":return e.stop()}}),e,null,[[3,24,28,32]])})))).apply(this,arguments)}function Se(e){document.getElementById("confirm-message").textContent=e,document.getElementById("confirm-modal").style.display="block",pe=!0}function ke(){document.getElementById("inactivity-modal").style.display="block",pe=!0,clearInterval(ue)}function Ee(){document.getElementById("inactivity-modal").style.display="none",pe=!1,Me()}function Me(){clearInterval(ue),ue=setInterval(me,7e3)}function Oe(){clearTimeout(de),de=setTimeout(ke,12e4)}window.onerror=function(e,t,n,r,o){return console.error("Error:",{message:e,url:t,line:n,column:r,error:o}),!1},document.addEventListener("DOMContentLoaded",(function(){return fe.apply(this,arguments)})),document.addEventListener("mousemove",Oe),document.addEventListener("keypress",Oe),window.addEventListener("beforeunload",(function(){ge.clear()})),window.hideIConfirmModal=function(){document.getElementById("confirm-modal").style.display="none",pe=!1,me()},window.refresh=function(){me()},window.exitPage=function(){Ee(),window.location.href="logout.html"},window.resumeSession=function(){Ee()}})();